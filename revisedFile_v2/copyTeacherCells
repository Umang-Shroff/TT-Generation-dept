Sub copyValuesToSheets()
    Dim wsSource As Worksheet
    Dim cell As Range
    Dim regex As Object
    Dim matchCollection As Object
    Dim match As Variant
    Dim sheetName As String
    Dim newSheet As Worksheet
    Dim excludedValues As Variant
    Dim destRow As Long, destCol As Long
    Dim found As Boolean
    
    ' Set the source sheet directly in the code
    Set wsSource = ThisWorkbook.Sheets("main") ' Specify the sheet name here
    
    ' Array of values to exclude from sheet creation
    excludedValues = Array("53", "54", "55", "L1", "L2", "L3", "64", "65", "66", "T")
    
    ' Create a regular expression object for pattern matching
    Set regex = CreateObject("VBScript.RegExp")
    regex.IgnoreCase = True
    regex.Global = True
    regex.Pattern = "\(([^)]+)\)" ' This will match text inside brackets
    
    ' Now, move the data from the "main" sheet to the respective sheets based on unique values found
    For Each cell In wsSource.UsedRange
        If cell.HasFormula = False Then ' Skip cells with formulas
            ' Apply regex to find matches in the cell content
            Set matchCollection = regex.Execute(cell.value)
            ' Loop through each match found
            For Each match In matchCollection
                ' Extract the value inside parentheses
                sheetName = match.SubMatches(0)
                
                ' Check if the sheetName is not in the excluded values
                If IsError(Application.match(sheetName, excludedValues, 0)) Then
                    ' Check if the sheet already exists
                    On Error Resume Next
                    Set newSheet = ThisWorkbook.Sheets(sheetName)
                    On Error GoTo 0
                    
                    ' If the sheet exists, transfer the data
                    If Not newSheet Is Nothing Then
                        ' Find the corresponding cell in the new sheet
                        destRow = cell.Row
                        destCol = cell.Column
                        
                        ' Copy the cell value to the corresponding cell in the new sheet
                        newSheet.Cells(destRow, destCol).value = cell.value
                    End If
                End If
            Next match
        End If
    Next cell
    
    MsgBox "Data has been transferred to the respective sheets."
End Sub

